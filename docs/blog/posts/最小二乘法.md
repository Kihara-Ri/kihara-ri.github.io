---
title: æœ€å°äºŒä¹˜æ³•
date: 2024-03-03
tags: 
  - æœ€å°äºŒä¹˜æ³•
  - æŸå¤±å‡½æ•°
categories: 
  - Math
---

# ğŸŸ  æœ€å°äºŒä¹˜æ³•

é«˜ä¸­æ—¶æœŸæˆ‘ä»¬å°±å­¦åˆ°äº†æœ€å°äºŒä¹˜æ³•ï¼Œå¯æƒœåˆ°ä¹‹åå†ä¹Ÿæ²¡æœ‰æ·±å…¥ï¼Œå…¶å®æ·±å…¥æ¢è®¨è¿™ä¸ªæ–¹æ³•åï¼Œæˆ‘ä»¬èƒ½å¤Ÿå¯¹äºå¹³å‡æ•°å’Œæ–¹å·®æœ‰æ›´æ·±å…¥çš„è®¤è¯†

<!-- more -->

[æœ€å°äºŒä¹˜æ³•](https://www.wikiwand.com/en/Least_squares?wprov=srpw1_0)(Ordinary Least Squares, OLS)æœ€æ—©ç”±[å‹’è®©å¾·](https://www.wikiwand.com/en/Adrien-Marie_Legendre)(Adrien-Marie Legendre)å’Œæ•°å­¦ç‹å­[é«˜æ–¯](https://www.wikiwand.com/en/Carl_Friedrich_Gauss)(Johann Carl Friedrich Gauss)åˆ†åˆ«å‘ç°å¹¶ä½¿ç”¨

å¯¹äºæˆ‘ä»¬æœ€å¸¸ç”¨çš„ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„å›å½’åˆ†æ$\hat y = \beta_0+\beta_1 \hat x$æœ‰ï¼š
$$
\begin{align}
\hat\beta_1 &= \frac{\sum(x_i-\bar x)(y_i-\bar y)}{\sum (x_i-\bar x)^2} \\
\hat\beta_0&= \bar y -\hat\beta_1 \bar x
\end{align}
$$

## äºŒç»´å˜é‡æœ€å°äºŒä¹˜æ³•çš„è¯æ˜

å¯¹äºä¸€ç»„æ•°æ®ï¼š
$$
X = \{(x_1,y_1),(x_2,y_2),\cdots , (x_m,y_m)\}
$$
æˆ‘ä»¬è®¤ä¸ºå®ƒç°åœ¨å¤§è‡´ç¬¦åˆä¸€ä¸ªçº¿æ€§æ–¹ç¨‹ï¼š
$$
y = \beta_0 +\beta_1x
$$
ä¹Ÿå°±æ˜¯æˆ‘ä»¬ç°åœ¨æƒ³è¦ç”¨è¿™ä¸ªçº¿æ€§æ–¹ç¨‹æ¥æ‹Ÿåˆè¿™ç»„æ•°æ®ï¼Œæ‹Ÿåˆå‡ºæ¥çš„ç›´çº¿è¦å°½å¤§å¯èƒ½åœ°ååº”å‡ºæ•°æ®çš„çœŸå®åˆ†å¸ƒæƒ…å†µï¼Œå‡­æˆ‘ä»¬æœ´ç´ çš„ç›´è§‰å½“ç„¶æ˜¯ä¸å…·æœ‰è¯´æœåŠ›çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ç§æ›´åŠ å®¢è§‚çš„æ–¹æ³•

æˆ‘ä»¬éœ€è¦è¡¨è¾¾å‡ºé¢„æµ‹å€¼ä¸çœŸå®å€¼ä¹‹é—´çš„å·®è·ï¼Œé‚£ä¹ˆå¦‚ä½•è¡¨è¾¾è¯¯å·®å‘¢ï¼Ÿ

å¯¹äºå…¶ä¸­ä»»ä¸€æ•°æ®$(x_i,y_i)$ï¼Œå…¶è¯¯å·®
$$
\Delta = y_i - (\beta_0+\beta_1x_i)
$$
æ˜¾ç„¶ï¼Œæ­£è¯¯å·®ä¸è´Ÿè¯¯å·®æ‰€è¡¨è¾¾çš„æ„ä¹‰å˜å¾—å®Œå…¨ä¸åŒäº†ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸è¡Œçš„ï¼Œè€ƒè™‘å¢åŠ ç»å¯¹å€¼ï¼Ÿ
$$
\Delta =\vert y_i - (\beta_0+\beta_1x_i)\vert
$$
è¿™ç§åšæ³•çœ‹ä¼¼èƒ½è¡Œï¼Œä½†å½“æˆ‘ä»¬ç´¯è®¡è¯¯å·®æ—¶ï¼š
$$
J(\beta) = \sum_{i=1}^m\vert y_i - (\beta_0+\beta_1x_i)\vert
$$
æˆ‘ä»¬é©¬ä¸Šå°±èƒ½çœ‹å‡ºé—®é¢˜äº†ï¼Œè¿™ç§è¡¨è¾¾æ–¹æ³•æ˜¯ä¸æ–¹ä¾¿è®¡ç®—çš„ï¼Œå¯¹äºå„ç§æ­£è´Ÿè¯¯å·®ï¼Œå¦‚æœéƒ½è¦è¿›è¡Œåˆ†ç±»è®¨è®ºï¼Œé‚£ä¹Ÿæœªå…å¤ªè¿‡ç¹çäº†ï¼Œè€Œä¸”ç”±äºå­˜åœ¨è¿‡å¤šæ‹ç‚¹ï¼Œå¯å¯¼æ€§ä¹Ÿå¾ˆå·®

ä¸å¦¨å–å¹³æ–¹ï¼ï¼ˆæ·±åº¦å­¦ä¹ ä¸­çš„è¯¯å·®å‡½æ•°ä¹Ÿé‡‡ç”¨äº†è¿™ç§æ–¹æ³•ï¼‰

äºæ˜¯
$$
J(\beta) = \sum_{i=1}^m (y_i - \beta_0-\beta_1x_i)^2
$$
ç°åœ¨æˆ‘ä»¬å°±å¾—åˆ°äº†è¿™æ ·ä¸€ä¸ªé‡åŒ–æŸå¤±çš„æŸå¤±å‡½æ•°ï¼Œåªéœ€è¦è®©$\beta_0$å’Œ$\beta_1$å–å¾—é€‚å½“çš„å€¼ï¼Œè®©æ€»ä½“çš„æŸå¤±å‡½æ•°å€¼æœ€å°å³å¯

åˆ†åˆ«å¯¹$\beta_0$å’Œ$\beta_1$æ±‚åå¯¼ï¼š
$$
\frac{\partial J(\beta)}{\partial \beta_0} = \sum_{i=1}^{m}2Â·(-1)(y_i - \beta_0-\beta_1x_i) = 2\sum_{i=1}^{m}(\beta_1x_i + \beta_0 - y_i) \tag{1}
$$

$$
\frac{\partial J(\beta)}{\partial \beta_1} = \sum_{i=1}^{m}2Â·(-x_i)(y_i - \beta_0-\beta_1x_i) = 2\sum_{i=1}^{m}(\beta_1x_i^2 + \beta_0x_i - x_iy_i) \tag{2}
$$

æˆ‘ä»¬çŸ¥é“
$$
\left\{
\begin{align}
\bar x = \frac{\sum_{i=1}^{m}x_i}{m}\\
\bar y = \frac{\sum_{i=1}^{m}y_i}{m}
\end{align}
\right.
$$
åˆ™
$$
\begin{align}
å¼(1) &= 2(\beta_1\sum_{i=1}^{m}x_i + \sum_{i=1}^{m}\beta_0 - \sum_{i=1}^{m}y_i)\\
 &= 2(m\beta_1\frac{\sum_{i=1}^{m}x_i}{m} + m\beta_0 - m\frac{\sum_{i=1}^{m}y_i}{m})\\
 &= 2(m\beta_1\bar x + m\beta_0 - m\bar y)\\
 &= 2m(\beta_1\bar x +\beta_0 - \bar y)
\end{align}
$$
ä»¤$\frac{\partial J(\beta)}{\partial\beta_0} = 0$ï¼Œåˆ™
$$
\beta_0 = \bar y - \beta_1 \bar x \tag{3}
$$
æˆ‘ä»¬å°†(3)ä»£å…¥(2)ä¸­æœ‰ï¼š
$$
(2)= 2 \sum_{i=1}^m(\beta_1x_i^2 + (\bar y -\beta_1 \bar x)x_i -x_iy_i) = 0
$$
å¯ä»¥æ±‚å‡º
$$
\beta_1 = \frac{\sum_{i=1}^mx_iy_i - \bar y\sum_{i=1}^mx_i}{\sum_{i=1}^mx_i^2 - \bar x\sum_{i=1}^mx_i}  \tag{4}
$$
è¿™é‡Œæˆ‘ä»¬æœ‰æ±‚å’Œæ€§è´¨ï¼š
$$
\sum_{i=1}^m(x_i - \bar x)(y_i - \bar y) = \sum_{i=1}^mx_iy_i - m\bar x\bar y = \sum_{i=1}^mx_iy_i - \bar y\sum_{i=1}^mx_i
$$
æœ‰äº†è¿™ä¸ªæ€§è´¨ï¼Œä»£å…¥(4)æœ‰
$$
\beta_1 = \frac{\sum(x_i-\bar x)(y_i-\bar y)}{\sum (x_i-\bar x)^2} \tag{*}
$$


å› æ­¤ï¼Œå¯¹
$$
\hat y = \beta_0+\beta_1 \hat x 
$$
æœ‰ï¼š
$$
\left\{
\begin{align}
\hat\beta_1 &= \frac{\sum(x_i-\bar x)(y_i-\bar y)}{\sum (x_i-\bar x)^2} \\
\hat\beta_0&= \bar y -\hat\beta_1 \bar x
\end{align}
\right.
$$

## å¤šå…ƒçº¿æ€§å›å½’

å¯¹äºå¤šç»´æ•°æ®ï¼Œæˆ‘ä»¬æœ‰ï¼š
$$
X\beta = Y
$$
å…¶ä¸­ï¼š
$$
X = 
\begin{bmatrix}
{1}&{x_{12}}&{\cdots}&{x_{1n}}\\
{1}&{x_{22}}&{\cdots}&{x_{2n}}\\
{\vdots}&{\vdots}&{\ddots}&{\vdots}\\
{1}&{x_{m2}}&{\cdots}&{x_{mn}}\\
\end{bmatrix}
,\quad
\beta = 
\begin{bmatrix}
\beta_0 \\ 
\beta_1 \\
\vdots \\
\beta_n
\end{bmatrix}	
,\quad
y = 
\begin{bmatrix}
y_1 \\ 
y_2 \\
\vdots \\
y_m
\end{bmatrix}	\\
\qquad \qquad \qquad m\times n\qquad\qquad\qquad n\times 1 \qquad\quad m\times 1
$$
ç›®æ ‡å‡½æ•°
$$
\begin{align}
J(\beta) &= \sum_{i=1}^m \vert y_i - \sum_{j=1}^nx_{ij}\beta_j\vert^2\\
&= \begin{Vmatrix} Y-X\beta \end{Vmatrix}	^2
\end{align}
$$

$$
\begin{align}
L(D,B) &= \begin{Vmatrix} Y-X\beta \end{Vmatrix}	^2 \\
&= (Y-X\beta)^T(Y-X\beta) \\
&= Y^TY-Y^TX\beta-\beta^TX^TY+\beta^TX^TX\beta
\end{align}
$$

$$
\begin{align}
\frac{\partial L(D,B)}{\partial\beta} &= \frac{\partial(Y^TY-Y^TX\beta-\beta^TX^TY+\beta^TX^TX\beta)}{\partial\beta}\\
&= -2X^TY + 2X^TX\beta = 0
\end{align}
$$

æ­¤æ—¶å¯ä»¥å¾—åˆ°
$$
\hat\beta = (X^TX)^{-1}X^TY
$$

## ä¸€ç‚¹é¢˜å¤–è¯

æˆ‘ä»¬åœ¨åˆ†ææœ€å°äºŒä¹˜æ³•çš„è¯¯å·®è®¡ç®—æ—¶ï¼Œè€ƒè™‘çš„è¯¯å·®å·®å€¼é‡‡å–çš„æ˜¯ç›´æ¥ç›¸å‡çš„æ–¹æ³•ï¼Œåœ¨ç®€å•æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä»¥äºŒç»´æ•°æ®ä¸ºä¾‹ï¼Œä¹Ÿå°±æ˜¯$y$æ–¹å‘çš„å·®å€¼ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬çš„å·®å€¼è®¡ç®—æ˜¯çºµå‘çš„ï¼Œè¿™ä¸ç‚¹åˆ°å›å½’æ›²çº¿çš„è·ç¦»è®¡ç®—å¾—å‡ºçš„ç»“æœæ˜¯å¦ç›¸åŒå‘¢ï¼Ÿ
